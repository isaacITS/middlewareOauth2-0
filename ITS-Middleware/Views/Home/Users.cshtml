@using ITS_Middleware.Models
@using System.Linq.Expressions
@model List<Usuario>

@{
    ViewData["Title"] = "Usuarios";
}

<h1 class="text-center">Administrador de Usuarios</h1>
<hr />
<a class="btn btn-primary" id="btnViewRegUser" data-bs-toggle="modal" data-bs-target="#modalRegister">
    <span class="material-icons">person_add</span>&nbsp;Agregar Usuario
</a>

<div class="table-responsive" id="usersTableContent">
    <table class="table table-striped table-hover" style="width:100%">
        <thead>
            <tr>
                <th>Nombre</th>
                <th>Correo</th>
                <th>Puesto</th>
                <th>Fecha de Alta</th>
                <th>Acciones</th>
                <th>Estatus</th>
            </tr>
        </thead>
        <tbody>
        @foreach (Usuario user in Model) 
        {
                <tr>
                    <td>@user.Nombre</td>
                    <td>@user.Email</td>
                    <td>@user.Puesto</td>
                    <td>@user.FechaAlta.ToShortDateString()</td>
                    <td>
                        <a class="btn btn-primary" asp-controller="Home" asp-route-id="@user.Id" asp-action="EditUser">
                            <span class="material-icons md-8">edit</span>
                        </a>
                        <a class="btn btn-danger" asp-controller="Home" asp-action="DeleteUser" asp-route-id="@user.Id">
                            <span class="material-icons md-8">delete</span>
                        </a>
                    </td>
                    <td>
                        <a class="btn btn-secondary" asp-controller="Home" asp-action="UpdateStatus" asp-route-id="@user.Id">
                            <span class="material-icons md-8">
                            @if (user.Activo)
                            {
                                <text>highlight_off</text>
                            } else
                            {
                                <text>check_circle_outline</text>
                            }
                            </span>
                        </a>
                     </td>
                    </tr>
            }
        </tbody>
    </table>
</div>

<!--Modals for CRUD-->
 <div class="modal fade" id="modalRegister" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-labelledby="staticBackdropLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h3 class="modal-title" id="staticBackdropLabel">Registrar usuario</h3>
                    <button type="button" class="btn-close btn-close-modal-views" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body" id="registerModalBody"></div>
            </div>
        </div>
</div>

@section scripts {
    <script src="~/js/DataTable.js" type="text/javascript"></script>
}